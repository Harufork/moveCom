{% extends 'orders/base_detail_order.html' %}
{% block data %}
<p>{{verbose.move_request}}: <a href="{{ object.move_request.get_absolute_url }}">{{ object.move_request }}</a></p>


<div class="btm_order_panel">
{% if not object.is_completed and not object.is_canceled %}



{% if object.is_confirm %}

  {% if perms.orders.cancel_move_order%}
  <form action="{% url 'cancel_move_order' %}" method="POST">
      {% csrf_token %}
      <input type="hidden" name="ordmoveid" value="{{ object.pk }}">
      <input class="abtn" type="submit" value="–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑">
  </form>
  {% endif %}

{% else %}

  {% if perms.orders.confirm_move_order%}
  <form action="{% url 'confirm_move_order' %}" method="POST">
      {% csrf_token %}
      <input type="hidden" name="ordmoveid" value="{{ object.pk }}">
      <input class="abtn btnfocus" type="submit" value="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑">
  </form>
  {% endif %}

  {% if bool_perm_of_user.change %}
    <a class="abtn" href="{{buttons_urls.change}}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
  {% endif %}

    {% if bool_perm_of_user.change %}
      <form action="{% url 'calc_total_cost_of_move_order' %}" method="POST">
      {% csrf_token %}
      <input type="hidden" name="ordmoveid" value="{{ object.pk }}">
      <input class="abtn" type="submit" value="–ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∏—Ç–æ–≥–æ–≤—É—é —Ü–µ–Ω—É">
  </form>
  {% endif %}

    {% if perms.orders.rejection_move_request%}
    <form action="{% url 'rejection_move_request' %}" method="POST">
        {% csrf_token %}
        <input type="hidden" name="reqmoveid" value="{{ object.move_request.pk }}">
        <input class="abtn" type="submit" value="–û—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞–∫–∞–∑">
    </form>
    {% endif %}
  {% endif %}

{% endif%}

{% if bool_perm_of_user.delete %}
<a class="abtn" href="{{buttons_urls.delete}}">–£–¥–∞–ª–∏—Ç—å</a>
{% endif %}
</div>
{% if object.is_confirm %}
<p>{{verbose.date_of_confirm}}: {{ object.date_of_confirm }}</p>
{% endif %}

<p>{{verbose.status}}: {{ object.move_request.get_status_display }}</p>
<p>{{verbose.total_cost}}: {{ object.total_cost }} —Ä—É–±.</p>
{% if bool_perm_routs.view %}
<h3>–ú–∞—Ä—à—Ä—É—Ç—ã</h3>
<table class="table">
    <tr>
        <th></th>
        <th>–ò–∑</th>
        <th>–ö—É–¥–∞</th>
        <th>–î–∏—Å—Ç–∞–Ω—Ü–∏—è</th>
        <th></th>
        {% if bool_perm_routs.change %}
        <th></th>
        {% endif %}
        {% if bool_perm_routs.delete %}
        <th></th>
        {% endif %}
    </tr>
    {%for rowobj in routs %}
    <tr>
        <td>{{forloop.counter}}</td>
        <td>{{rowobj.point_a}}</td>
        <td>{{rowobj.point_b}}</td>
        <td>{{rowobj.distance}} –∫–º.</td>
        <td class="btn_table"><a href="{{ rowobj.get_absolute_url }}">‚û•–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a></td>
        {% if bool_perm_routs.change %}
        <td class="btn_table"><a title="–ò–∑–º–µ–Ω–∏—Ç—å –æ–±—ä–µ–∫—Ç" href="{% url buttons_routs_urls.abstract_change rowobj.pk %}">‚úê–†–µ–¥</a></td>
        {% endif %}
        {% if bool_perm_routs.delete %}
        <td class="btn_table"><a class="del_table" href="{% url buttons_routs_urls.abstract_delete rowobj.pk %}" title="–£–¥–∞–ª–∏—Ç—å">üóë</a></td>
        {% endif %}
    </tr>
    {% endfor %}
</table>
{% endif %}
{% if bool_perm_employees.view %}
<h3>–ü–µ—Ä—Å–æ–Ω–∞–ª</h3>
<table class="table">
    <tr>
        <th></th>
        <th>–í—ã–ø–æ–ª–Ω—è–µ—Ç</th>
        <th>–†–æ–ª—å</th>
        <th>–ù–∞–π–º –Ω–∞</th>
        <th></th>
        {% if bool_perm_employees.change %}
        <th></th>
        {% endif %}
        {% if bool_perm_employees.delete %}
        <th></th>
        {% endif %}
    </tr>
    {%for rowobj in employees %}
    <tr>
        <td>{{forloop.counter}}</td>
        <td><a href="">{{rowobj.employee}}</a></td>
        <td><a href="">{{rowobj.group}}</a></td>
        <td>{{rowobj.hired_hours}} —á.</td>
        <td class="btn_table"><a href="{{ rowobj.get_absolute_url }}">‚û•–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a></td>
        {% if bool_perm_employees.change %}
        <td class="btn_table"><a title="–ò–∑–º–µ–Ω–∏—Ç—å –æ–±—ä–µ–∫—Ç" href="{% url buttons_employees_urls.abstract_change rowobj.pk %}">‚úê–†–µ–¥</a></td>
        {% endif %}
        {% if bool_perm_employees.delete %}
        <td class="btn_table"><a class="del_table" href="{% url buttons_employees_urls.abstract_delete rowobj.pk %}" title="–£–¥–∞–ª–∏—Ç—å">üóë</a></td>
        {% endif %}
    </tr>
    {% endfor %}
</table>
{% endif %}
{% if bool_perm_transports.view %}
<h3>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</h3>
<table class="table">
    <tr>
        <th></th>
        <th>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</th>
        <th>–í–∏–¥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞</th>
        <th>–ù–∞–π–º –Ω–∞</th>
        <th></th>
        {% if bool_perm_transports.change %}
        <th></th>
        {% endif %}
        {% if bool_perm_transports.delete %}
        <th></th>
        {% endif %}
    </tr>
    {%for rowobj in transports %}
    <tr>
        <td>{{forloop.counter}}</td>
        <td><a href="{{rowobj.transport.get_absolute_url}}">{{rowobj.transport}}</a></td>
        <td><a href="{{rowobj.mode_transport.get_absolute_url}}">{{rowobj.mode_transport}}</a></td>
        <td>{{rowobj.hired_hours}} —á.</td>
        <td class="btn_table"><a href="{{ rowobj.get_absolute_url }}">‚û•–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a></td>
        {% if bool_perm_transports.change %}
        <td class="btn_table"><a title="–ò–∑–º–µ–Ω–∏—Ç—å –æ–±—ä–µ–∫—Ç" href="{% url buttons_transports_urls.abstract_change rowobj.pk %}">‚úê–†–µ–¥</a></td>
        {% endif %}
        {% if bool_perm_transports.delete %}
        <td class="btn_table"><a class="del_table" href="{% url buttons_transports_urls.abstract_delete rowobj.pk %}" title="–£–¥–∞–ª–∏—Ç—å">üóë</a></td>
        {% endif %}
    </tr>
    {% endfor %}
</table>
{% endif %}
{% if bool_perm_packings.view %}
<h3>–ó–∞–∫–∞–∑–∞–Ω–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞</h3>
<p>{{verbose.receiving_packaging}}: {{ object.move_request.get_receiving_packaging_display }}</p>
<table class="table">
    <tr>
        <th></th>
        <th>–£–ø–∞–∫–æ–≤–∫–∞</th>
        <th>–ö–æ–ª-–≤–æ</th>
        <th>–ï–¥. –∏–∑–º.</th>
        <th></th>
        {% if bool_perm_packings.change %}
        <th></th>
        {% endif %}
        {% if bool_perm_packings.delete %}
        <th></th>
        {% endif %}
    </tr>
    {%for rowobj in packings %}
    <tr>
        <td>{{forloop.counter}}</td>
        <td><a href="{{rowobj.packing.get_absolute_url}}">{{rowobj.packing}}</a></td>
        <td>{{rowobj.total}}</td>
        <td><a href="{{rowobj.packing.unit.get_absolute_url}}">{{rowobj.packing.unit}}</a></td>
        <td class="btn_table"><a href="{{ rowobj.get_absolute_url }}">‚û•–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a></td>
        {% if bool_perm_packings.change %}
        <td class="btn_table"><a title="–ò–∑–º–µ–Ω–∏—Ç—å –æ–±—ä–µ–∫—Ç" href="{% url buttons_packings_urls.abstract_change rowobj.pk %}">‚úê–†–µ–¥</a></td>
        {% endif %}
        {% if bool_perm_packings.delete %}
        <td class="btn_table"><a class="del_table" href="{% url buttons_packings_urls.abstract_delete rowobj.pk %}" title="–£–¥–∞–ª–∏—Ç—å">üóë</a></td>
        {% endif %}
    </tr>
    {% endfor %}
</table>
{% endif %}
{% endblock %}